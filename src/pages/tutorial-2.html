---
layout: index
meta-title: "MidicaPL Tutorial 2: Improving - MIDI Programming Language for Midica"
---

<div class="grid-container midicapl">
	<div class="grid-x grid-padding-x">
		<h1 class="cell">MidicaPL Tutorial, Chapter 2: Improving</h1>
	</div>
	<section class="grid-x grid-padding-x" id="intro">
		<div class="cell">
			<h2>Introduction</h2>
		</div>
		<div class="cell">
			<p>
				This is the second chapter of the MidicaPL tutorial. Please read <a href="tutorial-1.html">Chapter 1</a> first,
				if you have not yet done that already.
			</p>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="channel-options">
		<div class="cell">
			<h2>Channel Options</h2>
		</div>
		<div class="cell medium-6">
			<p>
				As mentioned before, a channel command can have options. Everything after the length column is regarded as options.
				An option has a name and (most of the time) also a value, separated by <code>=</code> and/or whitespaces. If a channel command has
				more than one option, the options are separated by <code>,</code>. Additional whitespaces are allowed, but not needed.
			</p>
			<p>
				Each option has a long name and an abbreviation, which can be used instead of the long name. But enough theory, here are the options:
			</p>
		</div>
		<div class="cell medium-6">
			<table>
				<caption>
					Channel Options
				</caption>
				<thead>
					<tr>
						<th>Long Name</th>
						<th>Short Name</th>
						<th>Type</th>
						<th>Min Value</th>
						<th>Max Value</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>velocity</td>
						<td>v</td>
						<td>integer</td>
						<td>1</td>
						<td>127</td>
					</tr>
					<tr>
						<td>duration</td>
						<td>d</td>
						<td>float</td>
						<td>>0.0 (>0%)</td>
						<td>&infin;</td>
					</tr>
					<tr>
						<td>quantity</td>
						<td>q</td>
						<td>integer</td>
						<td>1</td>
						<td>&infin;</td>
					</tr>
					<tr>
						<td>multiple</td>
						<td>m</td>
						<td>none</td>
						<td>-</td>
						<td>-</td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="cell">
			<h3>Velocity</h3>
		</div>
		<div class="cell">
			<p>
				The velocity is the force with which a note is played. The more velocity, the louder the note. The option name is <code>velocity</code>.
				The short form is <code>v</code>.
			</p>
			<p>
				The value can be between 1 and 127. The default is 100. If the velocity option is used in a channel command, the following commands in the same
				channel will also use this velocity value. As long as the option is used in the same channel again, with a different value.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.velocity }}</div>
		<div class="cell">
			<p>
				The example shows different ways to use the long or short form of the option.
			</p>
		</div>
		<div class="cell">
			<h3>Duration</h3>
		</div>
		<div class="cell">
			<p>
				The duration option describes after which percentage of the note length, the pressed key is released.
				The option name is <code>duration</code>. The short form is <code>d</code>.
				The values can be either floating point numbers or percentage values ending with <code>%</code>.
				Low values result in "staccato", high values result in "legato".
			</p>
			<p>
				If two notes are played after each other, and the duration value is 1.0 (or 100%) then the first note is released in the same
				moment when the second one is pressed. A value of 0.9 (or 90%) means that the first note is released after 90% of its
				official duration. So the note is 10% shorter than its theoretical length.
			</p>
			<p>
				The default value is 0.95 (or 95%), meaning that the key is released 5% before its theoretical end.
				Values greater than 1.0 are also allowed. Then the notes overlap: The former note is released after the following one begins.
			</p>
			<p>
				If the duration option is used in a channel command, the following commands in the same channel will use the same duration value.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.duration-ratio }}</div>
		<div class="cell">
			<p>
				This example shows different ways how to use the long or short form of the duration option, with a floating point or percentage value.
				The last two lines show how different options can be combined. In this case duration and velocity.
			</p>
		</div>
		<div class="cell">
			<h3>Quantity</h3>
		</div>
		<div class="cell">
			<p>
				With the quantity option you can repeat the same channel command any number of times. The option name is <code>quantity</code>.
				The short form is <code>q</code>.
			</p>
			<p>
				The following example shows the beginning of "The Four Seasons: Summer", 3rd movement, by "Antonio Vivaldi".
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.quantity }}</div>
		<div class="cell">
			<p>
				As you can see, this option can reduce the source code lines. In channel 1 it is used for 8th notes, together with a duration value
				of 50%.
				This is an alternative to combining 16th notes with 16th rests.
			</p>
		</div>
		<div class="cell">
			<h3>Multiple</h3>
		</div>
		<div class="cell">
			<p>
				The multiple option is used to play different voices in the same channel.
				It allows to play different notes with different lengths and/or different velocity or duration options in
				the same time and channel.
				The option name is <code>multiple</code>. The short form is <code>m</code>. It does not have any value.
			</p>
			<p>
				As we already know, each channel command appends a note (or a chord or a rest) to the end of a channel. To be more precise,
				it adds the note to a <em>marker</em> that is usually at the end of the channel.
				After adding the note, this marker is moved from the old end of the channel to the new end of the channel.
			</p>
			<p>
				But if the channel command has the multiple option, the marker is not moved.
				So the next note that is added to the channel, begins at the same time like the note with the multiple option.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.multiple }}</div>
		<div class="cell">
			<p>
				This example shows some possibilities to use the multiple option. The first bar uses 2 voices, shown as blue and black.
				The full note and the first quarter note (g) begin in the same time because of the multiple option.
			</p>
			<p>
				In the second example we have 2 voices again (blue and black). But they don't begin in the same time, so we need to add
				a rest in the black voice. The blue voice sounds longer than the black one, so we need another rest at the end of the
				second bar.
			</p>
			<p>
				In the third bar we have three voices: blue, green and black. They all begin at different times but end in the same time.
			</p>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="length-definitions">
		<div class="cell">
			<h2>Length Definitions</h2>
		</div>
		<div class="cell">
			<p>
				As you learned in chapter 1, the third column of a channel command defines the length of the note (or chord or rest).
				The easyest form of such a length definition is an atomic length like <code>/4</code>. This can be modified by special symbols like
				<code>.</code>. Most of the time you don't need anything more. But in some cases you may need more complicated definitions. In those
				cases you can combine more than one length definition and build a sum of them.
			</p>
			<p>
				<h3>Atomic Lengths</h3>
			</p>
			<p>
				The following atomic lengths are defined:
			</p>
			<p>
				<code>/1</code> (full),
				<code>/2</code> (half),
				<code>/4</code> (quarter),
				<code>/8</code> (eighth),
				<code>/16</code> (sixteenth),
				<code>/32</code> (thirty-second)
			</p>
			<p>
				<code>*1</code> (full),
				<code>*2</code> (double),
				<code>*4</code> (four wholes),
				<code>*8</code> (eight wholes),
				<code>*16</code> (sixteen wholes),
				<code>*32</code> (thirty-two wholes)
			</p>
			<p>
				You can also use just numbers without <code>/</code> or <code>*</code>. In this case, the number is interpreted as Xth note.
				This way you can also have more notes than the ones described above. E.g. <code>64</code> is interpreted as a sixty-fourth note (1/64).
				Or <code>5</code> will be a fifth note (1/5).
			</p>
			<p>
				The reason, this tutorial uses <code>/4</code> instead of <code>4</code> most of the time is that it's just more readable.
				But the result is the same.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.atomic }}</div>
		<div class="cell">
			<p>
				<h3>Modified Lengths</h3>
			</p>
			<p>
				<h4>Dots</h4>
			</p>
			<p>
				An atomic length can be modified. You already know the modifier <code>.</code>. It makes the atomic length one half longer, so that it's 3/2
				of the atomic length.
				You can add as many dots as you want. Two dots (<code>..</code>) make it longer by three quarters, resulting in 7/4 of it's atomic length.
				Three dots result in 15/8. And so on.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.dot }}</div>
		<div class="cell">
			<p>
				Channel 1 is only added for comparison reasons.
			</p>
		</div>
		<div class="cell">
			<p>
				<h4>Triplets</h4>
			</p>
			<p>
				A triplet shortens the atomic length by one third, resulting in 2/3 of the atomic length.
				The triplet symbol is a <code>t</code>.
				Just like a dot, a triplet can be applied as often as you want, resulting in nested triplets.
				Two triplet symbols result in a length of 4/9 (2/3 * 2/3). Three such symbols result in 8/27 (2/3 * 2/3 * 2/3). And so on.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.triplet }}</div>
		<div class="cell">
			<p>
				Channel 1 is added for comparison reasons again.
				The first triplet consists of 3 shortened eighths taking the time of a quarter.
				The second triplet is only slightly more complicated. It also contains a dotted eighth and a sixteenth.
			</p>
			<p>
				The third triplet contains a dotted note again. But this time the dot is before the <code>t</code> symbol. This demonstrates that the order
				of modifiers does not matter. The triplet also contains a rest that needs to have a modified length as well.
			</p>
			<p>
				The fourth triplet contains a nested triplet, marked in blue. So the notes of the inner triplet need to be modified by two
				<code>t</code> symbols.
			</p>
			<p>
				The last triplet consists of three half notes having the length of one full note. It also contains a chord.
			</p>
		</div>
		<div class="cell">
			<p>
				<h4>Tuplets</h4>
			</p>
			<p>
				A triplet is only one special type of tuplet. Generally a tuplet is used to change the length of a sequence of notes in a way that
				has to be defined in the tuplet definition. A Tuplet is defined by the symbol <code>t</code>, followed by two numbers that are separated by
				<code>:</code>. A triplet could also be defined as <code>t3:2</code> meaning something like "3 for 2" or "3 notes have the length of 2".
			</p>
			<p>
				Mathematically you can say: tX:Y means that the length is multiplied with Y/X. So a note inside of a quadruplet would be modified with
				<code>t4:3</code>. And something inside a quintuplet with <code>t5:4</code>.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.tuplet }}</div>
		<div class="cell">
			<p>
				Again, channel 1 is only added for comparison reasons.
				The first tuplet is a 5:2 tuplet that could contain 5 notes (or rests) with the length of 2. So the length of each note or rest
				is modified by 2/5.
			</p>
			<p>
				The second tuplet is a 3:4 tuplet modifying all lengths by 4/3. So you see that a tuplet can also be defined to make notes longer
				instead of shorter. This tuplet contains a nested triplet (marked in blue) that has been explicitely defined as <code>t3:2</code>
				instead of <code>t</code>. Because of the nesting, both tuplet modifiers have to be attached to each other.
			</p>
			<p>
				The last tuplet contains different note lengths and a chord.
			</p>
		</div>
		<div class="cell">
			<p>
				<h3>Sums of Lengths</h3>
			</p>
			<p>
				Sometimes a note length cannot be described easily with an atomic or modified length. But it can easily be described as a sum of two lengths.
				In sheet music such notes are typically printed as 2 notes with a <em>tie</em> between them.
				In MidicaPL such a note length can be described as two atomic or modified lenghts, separated by a <code>+</code> symbol.
			</p>
			<p>
				The following example shows the first few notes of "Hey Jude" by the "Beatles".
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.hey-jude }}</div>
		<div class="cell">
			<p>
				A half and an eighth note are tied together. This is described as <code>/2+/4</code>.
			</p>
			<p>
				More complicated expressions are also possible like <code>/2.+/1+/2t</code>:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.length-plus }}</div>
	</section>
	<section class="grid-x grid-padding-x" id="percussion">
		<div class="cell">
			<h2>Percussion Instruments</h2>
		</div>
		<div class="cell">
			<p>
				In order to produce sounds, we learned how to configure a certain instrument for a channel. Then we used notes to play
				different pitches in that channel. With Percussion instruments this is different.
				A percussion instrument has only one pitch. It's somthing like a drum, a hand clap, a cow bell or a triangle.
				Using notes for such instruments is not very useful.
			</p>
			<p>
				Percussion instruments are usually played in channel 9, the special percussion channel. In the <code>INSTRUMENTS</code> block
				this channel cannot be associated with an instrument but with a drumkit.
			</p>
			<p>
				When playing something later in this channel, this is not a note but a certain percussion instrument.
				Instead of the note name you write a percussion ID. Each percussion instrument has a long ID and a short ID.
				The valid IDs can be seen in the <em>info window</em> under <a href="/#info-config">Configuration / Percussion IDs</a>.
			</p>
			<p>
				The next two examples are equivalent. They play the intro for "We Will Rock You" by "Queen".
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.we-will-rock-you }}</div>
		<div class="cell">
			<p>
				The only difference is that the first example uses long percussion IDs and the second one uses short IDs.
			</p>
			<p>
				Like a chord of notes, you can also play two percussion sounds in the same time. Just separate the IDs with a <code>,</code>.
				The following example shows the bedinning of "Billie Jean" by "Michael Jackson".
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.billie-jean }}</div>
		<div class="cell">
			<p>
			</p>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="soundfonts">
		<div class="cell">
			<h2>Using Soundfonts</h2>
		</div>
		<div class="cell">
			The first thing to be defined inside of a source file must be the instruments that each channel uses.
			Each channel that will be used later must be initialized inside of a block beginning with
			<code>INSTRUMENTS</code> and ending with <code>END</code>.
		</div>
		<div class="cell medium-shrink">{{> src-example src-examples.instruments }}</div>
		<div class="cell medium-auto">
			Each line inside this block contains 3 columns, separated by one or more whitespaces.
			The last column may also contain more whitespaces. These are not interpreted as separator but as a part of the content.
		</div>
		<div class="cell">{{!-- ensure a line break --}}</div>
		<div class="cell large-4">
			<h3>1st column</h3>
			<p>
				The first column contains the chanel number. Valid values are the numbers <code>0</code> - <code>15</code> and the symbol <code>p</code>.
			</p>
			<p>
				<code>p</code> is just an alias for <code>9</code> which is the percussion channel number.
			</p>
		</div>
		<div class="cell large-4">
			<h3>2nd column</h3>
			<p>
				The second column describes the instrument or drumkit. In the simplest form it can just be identical with an
				<u>instrument ID</u>, a <u>percussion ID</u> or a program number. But it may also contain a bank description,
				separated from the ID or number by a <code>,</code> symbol.
			</p>
			<p>
				The bank description can either be the full bank number or the bank <abbr title="Most Significant Byte">MSB</abbr> and
				<abbr title="Least Significant Byte">LSB</abbr>, separated by a <code>/</code> symbol. Or it can only be the
				bank MSB, if the LSB is 0.
			</p>
		</div>
		<div class="cell large-4">
			<h3>3rd column</h3>
			The third column contains a description of the instrument. This will be displayed as a channel comment in the player.
		</div>
		<div class="cell">
			The following example assumes that the currently loaded soundfont supports a multi-channel drumkit on bank 15360 (MSB 120, LSB 0).
			Otherwise the drums could only be used in channel <em>9</em>.
		</div>
		<div class="cell">{{> src-example src-examples.instruments-2 }}</div>
	</section>
	<aside>
		Now you know most of the lowlevel commands of MidicaPL. Please continue with <a href="tutorial-1.html">chapter 3</a> to learn about
		highlevel syntax like blocks and macros.
	</aside>
</div>
